var v=Object.defineProperty;var x=(s,e,t)=>e in s?v(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var a=(s,e,t)=>(x(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const n of h.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(i){if(i.ep)return;i.ep=!0;const h=t(i);fetch(i.href,h)}})();class y{constructor(e,t){a(this,"width");a(this,"height");a(this,"x");a(this,"y");a(this,"canvasWidth");a(this,"canvasHeight");a(this,"speed");a(this,"movingLeft");a(this,"movingRight");a(this,"paddleImages");a(this,"animationFrame");a(this,"frameDelay");a(this,"frameDelayCounter");this.width=90,this.height=10,this.x=(e-this.width)/2,this.y=t-this.height-10,this.canvasWidth=e,this.canvasHeight=t,this.speed=6,this.movingLeft=!1,this.movingRight=!1,this.paddleImages=[],this.animationFrame=0,this.frameDelay=10,this.frameDelayCounter=0,this.preloadPaddleImages()}preloadPaddleImages(){for(let e=0;e<3;e++){const t=new Image;t.src=`./images/paddle_${e}.png`,this.paddleImages.push(t)}}moveLeft(){this.x>0&&(this.x-=this.speed)}moveRight(){this.x+this.width<this.canvasWidth&&(this.x+=this.speed)}update(){this.movingLeft&&this.moveLeft(),this.movingRight&&this.moveRight(),this.frameDelayCounter++,this.frameDelayCounter>=this.frameDelay&&(this.animationFrame=(this.animationFrame+1)%this.paddleImages.length,this.frameDelayCounter=0)}draw(e){const h=this.width/3.7890625,n=this.y-h+this.height;e.drawImage(this.paddleImages[this.animationFrame],this.x,n,this.width,h)}}function r(s){const e=new Audio(s);return e.load(),e}const c={brick:r("sounds/brick.mp3"),gameover:r("sounds/gameover.mp3"),go:r("sounds/go.mp3"),levelup:r("sounds/levelup.mp3"),loselife:r("sounds/loselife.mp3"),paddle:r("sounds/paddle.mp3")};function d(s){s.paused||(s.pause(),s.currentTime=0),s.play()}const m=r("sounds/music.wav");m.loop=!0;m.volume=.15;let u=!1;function b(){u||(m.play(),u=!0,m.addEventListener("timeupdate",function(){this.currentTime>this.duration-.3&&(this.currentTime=0,this.play())},!1))}class w{constructor(e,t,o,i){a(this,"paddle");a(this,"getCurrentState");a(this,"restartGame");a(this,"startGame");this.paddle=e,this.getCurrentState=t,this.restartGame=o,this.startGame=i,document.addEventListener("keydown",h=>this.keyDownHandler(h)),document.addEventListener("keyup",h=>this.keyUpHandler(h))}keyDownHandler(e){const t=this.getCurrentState();if(t==="playing")switch(e.key){case"ArrowLeft":this.paddle.movingLeft=!0;break;case"ArrowRight":this.paddle.movingRight=!0;break}else t==="gameOver"?this.restartGame():t==="starting"&&(b(),this.startGame())}keyUpHandler(e){if(this.getCurrentState()==="playing")switch(e.key){case"ArrowLeft":this.paddle.movingLeft=!1;break;case"ArrowRight":this.paddle.movingRight=!1;break}}}class k{constructor(e){a(this,"name");a(this,"highScore");a(this,"score");a(this,"level");a(this,"lives");this.name=e,this.highScore=Number(localStorage.getItem("highScore"))||0,this.score=0,this.level=1,this.lives=3}increaseScore(e){this.score+=e,this.score>this.highScore&&(this.highScore=this.score,this.saveHighScore())}getHighScore(){return Number(localStorage.getItem("highScore"))||0}saveHighScore(){localStorage.setItem("highScore",this.score.toString())}reset(){this.score=0,this.level=1,this.lives=3}levelUp(){this.level++}}class S{constructor(e,t,o){a(this,"x");a(this,"y");a(this,"radius");a(this,"dx",0);a(this,"dy",0);a(this,"baseSpeed");a(this,"speedIncrease");a(this,"ballImage");this.x=e,this.y=t,this.radius=o,this.baseSpeed=5,this.speedIncrease=0,this.ballImage=new Image,this.preloadBallImage(),this.setInitialVelocity()}preloadBallImage(){this.ballImage.src="./images/ball.png"}setInitialVelocity(){const e=this.baseSpeed+this.speedIncrease;this.dx=(Math.random()*2-1)*e,this.dy=-e}draw(e){const t=this.radius*2;e.drawImage(this.ballImage,this.x-this.radius,this.y-this.radius,t,t)}reset(e,t){this.x=e,this.y=t,this.speedIncrease=0,this.setInitialVelocity()}increaseSpeed(e){this.speedIncrease+=e,this.setInitialVelocity()}update(e,t){if((this.x+this.dx>e-this.radius||this.x+this.dx<this.radius)&&(this.dx=-this.dx),this.y+this.dy<this.radius&&(this.dy=-this.dy),this.x>t.x&&this.x<t.x+t.width&&this.y+this.radius>t.y){this.dy=-this.dy;const o=this.x-(t.x+t.width/2);this.dx=o*.1,d(c.paddle)}this.x+=this.dx,this.y+=this.dy}}class L{constructor(e,t,o,i,h,n,l=1){a(this,"x");a(this,"y");a(this,"width");a(this,"height");a(this,"health");a(this,"initialHealth");a(this,"colorIndex");a(this,"image");a(this,"images");this.x=e,this.y=t,this.width=o,this.height=i,this.colorIndex=h,this.images=n,this.image=this.images.new,this.health=l,this.initialHealth=l}hit(){this.health-=1,this.health===1&&this.initialHealth>1&&(this.image=this.images.broken)}draw(e){this.health>0&&e.drawImage(this.image,this.x,this.y,this.width,this.height)}}const C=[{columnCount:7,backgroundImage:"./images/background_6.png",bricks:[{health:1,colorIndex:1},{health:1,colorIndex:0},{health:1,colorIndex:7},{health:2,colorIndex:6},{health:2,colorIndex:8},{health:2,colorIndex:5},{health:2,colorIndex:3}]},{columnCount:7,backgroundImage:"./images/background_7.png",bricks:[{health:1,colorIndex:9},{health:2,colorIndex:8},{health:2,colorIndex:1},{health:2,colorIndex:5},{health:2,colorIndex:6},{health:2,colorIndex:3},{health:1,colorIndex:7}]},{columnCount:9,backgroundImage:"./images/background_8.jpeg",bricks:[{health:2,colorIndex:2},{health:1,colorIndex:8},{health:2,colorIndex:3}]},{columnCount:9,backgroundImage:"./images/background_9.jpeg",bricks:[{health:1,colorIndex:4},{health:1,colorIndex:6},{health:2,colorIndex:2},{health:1,colorIndex:7},{health:1,colorIndex:5},{health:1,colorIndex:1},{health:2,colorIndex:3},{health:2,colorIndex:0},{health:2,colorIndex:9}]},{columnCount:9,backgroundImage:"./images/background_13.jpeg",bricks:[{health:2,colorIndex:5},{health:2,colorIndex:3},{health:1,colorIndex:4}]},{columnCount:8,backgroundImage:"./images/background_10.jpeg",bricks:[{health:1,colorIndex:0},{health:2,colorIndex:2},{health:1,colorIndex:1},{health:1,colorIndex:4},{health:1,colorIndex:5},{health:1,colorIndex:9},{health:2,colorIndex:7},{health:1,colorIndex:8},{health:2,colorIndex:6}]},{columnCount:9,backgroundImage:"./images/background_7.png",bricks:[{health:1,colorIndex:5},{health:2,colorIndex:9},{health:1,colorIndex:7},{health:1,colorIndex:6},{health:2,colorIndex:3},{health:2,colorIndex:4},{health:1,colorIndex:0},{health:1,colorIndex:1}]},{columnCount:8,backgroundImage:"./images/background_6.png",bricks:[{health:1,colorIndex:5},{health:1,colorIndex:7},{health:1,colorIndex:9},{health:2,colorIndex:6}]},{columnCount:7,backgroundImage:"./images/background_10.jpeg",bricks:[{health:2,colorIndex:0},{health:2,colorIndex:7},{health:1,colorIndex:2},{health:2,colorIndex:9},{health:2,colorIndex:8},{health:1,colorIndex:3},{health:2,colorIndex:4}]},{columnCount:9,backgroundImage:"./images/background_12.jpeg",bricks:[{health:2,colorIndex:8},{health:2,colorIndex:6},{health:2,colorIndex:4}]}];class p{constructor(e){a(this,"game");a(this,"backgroundImage");a(this,"backgroundImages");a(this,"bricks",[]);a(this,"brickImages",{});a(this,"width");a(this,"height");a(this,"padding");a(this,"offsetTop");this.game=e,this.backgroundImages=["./images/background_6.png","./images/background_7.png","./images/background_8.jpeg","./images/background_9.jpeg","./images/background_10.jpeg","./images/background_11.jpeg","./images/background_12.jpeg","./images/background_13.jpeg","./images/background_14.jpeg"],this.backgroundImage=this.loadBackgroundImage(),this.preloadBrickImages().then(()=>this.generateBricks()),this.width=75,this.height=20,this.padding=10,this.offsetTop=30}async preloadBrickImages(){const t=i=>new Promise(h=>{const n=new Image;n.onload=()=>h(n),n.src=i}),o=[];for(let i=0;i<10;i++){const h=`./images/brick_0${i}_new.png`,n=`./images/brick_0${i}_broken.png`;o.push(Promise.all([t(h),t(n)]).then(([l,g])=>{this.brickImages[i]={new:l,broken:g}}))}await Promise.all(o)}loadBackgroundImage(){const e=this.game.player.level%this.backgroundImages.length-1;let t=new Image;return t.src=this.backgroundImages[e],t}generateBricks(){const e=this.game.player.level-1,t=C[e];this.backgroundImage.src=t.backgroundImage;let o=(this.game.canvas.width-(t.columnCount*(this.width+this.padding)-this.padding))/2;t.bricks.forEach((i,h)=>{let n=h*(this.height+this.padding)+this.offsetTop;const l={new:this.brickImages[i.colorIndex].new,broken:this.brickImages[i.colorIndex].broken};for(let g=0;g<t.columnCount;g++){let f=g*(this.width+this.padding)+o;this.bricks.push(new L(f,n,this.width,this.height,i.colorIndex,l,i.health))}})}checkLevelProgression(){this.bricks.every(t=>t.health<=0)&&(this.game.player.levelUp(),this.generateBricks(),this.game.resetBallAndPaddle(),d(c.levelup),this.loadBackgroundImage())}checkBallBrickCollision(){this.bricks.forEach(e=>{e.health>0&&this.game.ball.x>e.x&&this.game.ball.x<e.x+e.width&&this.game.ball.y>e.y&&this.game.ball.y<e.y+e.height&&(this.game.ball.dy*=-1,e.hit(),this.game.player.increaseScore(1),d(c.brick),this.checkLevelProgression())})}draw(e){this.backgroundImage.complete?e.drawImage(this.backgroundImage,0,0,e.canvas.width,e.canvas.height):this.backgroundImage.onload=()=>{e.drawImage(this.backgroundImage,0,0,e.canvas.width,e.canvas.height)},this.bricks.forEach(t=>t.draw(e))}}function B(s){const e=document.getElementById("levelDisplay");e&&(e.innerHTML="Level: "+s)}function I(s){const e=document.getElementById("livesDisplay");if(e){e.innerHTML="";for(let t=0;t<s;t++){let o=document.createElement("div");o.classList.add("heart"),e.appendChild(o)}}}function _(s){const e=document.getElementById("scoreDisplay");e&&(e.innerHTML="Score: "+s)}function H(s){const e=document.getElementById("highScoreDisplay");e&&(e.innerHTML="High Score: "+s)}class P{constructor(e){a(this,"canvas");a(this,"ctx");a(this,"player");a(this,"paddle");a(this,"level");a(this,"ball");a(this,"inputHandler");a(this,"currentState");a(this,"animationFrameId");const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Canvas element not found");this.canvas=t,this.canvas.width=800,this.canvas.height=600,this.ctx=this.canvas.getContext("2d"),this.player=new k("Player1"),this.paddle=new y(this.canvas.width,this.canvas.height),this.level=new p(this),this.ball=new S(this.canvas.width/2,this.canvas.height-40,10),this.currentState="starting",this.inputHandler=new w(this.paddle,()=>this.currentState,()=>this.restartGame(),()=>this.startGame())}startGame(){this.currentState="playing",d(c.go),this.gameLoop()}checkBallBottomCollision(){this.ball.y+this.ball.dy>this.canvas.height-this.ball.radius&&this.loseLife()}loseLife(){this.player.lives-=1,I(this.player.lives),this.player.lives<=0?(this.currentState="gameOver",d(c.gameover)):(this.resetBallAndPaddle(),d(c.loselife))}resetBallAndPaddle(){this.ball.reset(this.canvas.width/2,this.canvas.height-30),this.paddle.x=(this.canvas.width-this.paddle.width)/2}updateGame(){this.paddle.update(),this.ball.update(this.canvas.width,this.paddle),this.level.checkBallBrickCollision(),this.checkBallBottomCollision()}drawGame(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.level.draw(this.ctx),I(this.player.lives),this.ball.draw(this.ctx),this.paddle.draw(this.ctx),B(this.player.level),_(this.player.score),H(this.player.highScore)}drawStartScreen(){const e=new Image;e.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height)},e.src="./images/splash_screen_2.png"}drawGameOver(){this.animationFrameId!==void 0&&cancelAnimationFrame(this.animationFrameId);const e=new Image;e.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height)},e.src="./images/game_over_screen_3.png"}gameLoop(){switch(this.currentState){case"starting":this.drawStartScreen();break;case"playing":this.updateGame(),this.drawGame(),this.animationFrameId=requestAnimationFrame(()=>this.gameLoop());break;case"gameOver":this.drawGameOver();break}}restartGame(){typeof this.animationFrameId<"u"&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0),this.player.reset(),this.level=new p(this),this.resetBallAndPaddle(),this.currentState="playing",this.gameLoop()}}const D=new P("gameCanvas");document.addEventListener("DOMContentLoaded",()=>{D.gameLoop()});
