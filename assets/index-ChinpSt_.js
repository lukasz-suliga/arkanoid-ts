var m=Object.defineProperty;var u=(n,e,t)=>e in n?m(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var a=(n,e,t)=>(u(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const o of h.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(i){if(i.ep)return;i.ep=!0;const h=t(i);fetch(i.href,h)}})();class p{constructor(e,t){a(this,"width");a(this,"height");a(this,"x");a(this,"y");a(this,"canvasWidth");a(this,"canvasHeight");a(this,"speed");a(this,"movingLeft");a(this,"movingRight");a(this,"paddleImages");a(this,"animationFrame");a(this,"frameDelay");a(this,"frameDelayCounter");a(this,"lastTouchX");this.width=90,this.height=10,this.x=(e-this.width)/2,this.y=t-this.height-10,this.canvasWidth=e,this.canvasHeight=t,this.speed=12,this.movingLeft=!1,this.movingRight=!1,this.paddleImages=[],this.animationFrame=0,this.frameDelay=10,this.frameDelayCounter=0,this.preloadPaddleImages(),this.lastTouchX=null}preloadPaddleImages(){for(let e=0;e<3;e++){const t=new Image;t.src=`./images/paddle_${e}.png`,this.paddleImages.push(t)}}moveLeft(){this.x>0&&(this.x-=this.speed)}moveRight(){this.x+this.width<this.canvasWidth&&(this.x+=this.speed)}update(){this.movingLeft&&this.moveLeft(),this.movingRight&&this.moveRight(),this.frameDelayCounter++,this.frameDelayCounter>=this.frameDelay&&(this.animationFrame=(this.animationFrame+1)%this.paddleImages.length,this.frameDelayCounter=0)}draw(e){const h=this.width/3.7890625,o=this.y-h+this.height;e.drawImage(this.paddleImages[this.animationFrame],this.x,o,this.width,h)}}class I{constructor(e){a(this,"game");this.game=e,document.addEventListener("keydown",t=>this.keyDownHandler(t)),document.addEventListener("keyup",t=>this.keyUpHandler(t)),document.addEventListener("touchstart",t=>this.touchStartHandler(t)),document.addEventListener("touchmove",t=>this.touchMoveHandler(t)),document.addEventListener("touchend",()=>this.touchEndHandler())}touchStartHandler(e){const t=this.game.currentState;t==="starting"?this.game.startGame():t==="gameOver"&&this.game.restartGame(),this.game.paddle.lastTouchX=e.touches[0].clientX}touchMoveHandler(e){if(!this.game.paddle.lastTouchX)return;const t=e.touches[0].clientX,s=t-this.game.paddle.lastTouchX;s<0?(this.game.paddle.movingLeft=!0,this.game.paddle.movingRight=!1):s>0&&(this.game.paddle.movingLeft=!1,this.game.paddle.movingRight=!0),this.game.paddle.lastTouchX=t}touchEndHandler(){this.game.paddle.movingLeft=!1,this.game.paddle.movingRight=!1,this.game.paddle.lastTouchX=null}keyDownHandler(e){const t=this.game.currentState;if(t==="playing")switch(e.key){case"ArrowLeft":this.game.paddle.movingLeft=!0;break;case"ArrowRight":this.game.paddle.movingRight=!0;break;case"Escape":this.game.paddle.movingRight=!1,this.game.paddle.movingLeft=!1,this.game.previousState="playing",this.game.currentState="options";break}else if(t==="gameOver")this.game.restartGame();else if(t==="starting")switch(this.game.soundManager.musicOn&&this.game.soundManager.tryPlayMusic(),e.key){case"ArrowUp":this.game.activeStartMenuItem=(this.game.activeStartMenuItem-1+this.game.startMenuItems.length)%this.game.startMenuItems.length,this.game.drawStartScreen();break;case"ArrowDown":this.game.activeStartMenuItem=(this.game.activeStartMenuItem+1)%this.game.startMenuItems.length,this.game.drawStartScreen();break;case"Enter":this.game.activeStartMenuItem===0?this.game.startGame():this.game.activeStartMenuItem===1&&(this.game.previousState="starting",this.game.currentState="options",this.game.drawOptionsScreen());break}else if(t==="options"){switch(e.key){case"ArrowUp":this.game.activeOptionsMenuItem=(this.game.activeOptionsMenuItem-1+this.game.optionsMenuItems.length)%this.game.optionsMenuItems.length;break;case"ArrowDown":this.game.activeOptionsMenuItem=(this.game.activeOptionsMenuItem+1)%this.game.optionsMenuItems.length;break;case"Enter":this.game.activeOptionsMenuItem===0?this.game.soundManager.toggleMusic():this.game.activeOptionsMenuItem===1?this.game.soundManager.toggleSound():this.game.activeOptionsMenuItem===2&&(this.game.currentState=this.game.previousState);break;case"Escape":this.game.currentState=this.game.previousState;break}this.game.currentState==="options"?this.game.drawOptionsScreen():this.game.currentState==="starting"?this.game.drawStartScreen():this.game.currentState==="playing"&&(this.game.updateGame(),this.game.drawGame(),this.game.animationFrameId=requestAnimationFrame(()=>this.game.gameLoop()))}}keyUpHandler(e){if(this.game.currentState==="playing")switch(e.key){case"ArrowLeft":this.game.paddle.movingLeft=!1;break;case"ArrowRight":this.game.paddle.movingRight=!1;break}}}class v{constructor(e){a(this,"name");a(this,"highScore");a(this,"score");a(this,"level");a(this,"lives");this.name=e,this.highScore=Number(localStorage.getItem("highScore"))||0,this.score=0,this.level=0,this.lives=0,this.reset()}increaseScore(e){this.score+=e,this.score>this.highScore&&(this.highScore=this.score,this.saveHighScore())}getHighScore(){return Number(localStorage.getItem("highScore"))||0}saveHighScore(){localStorage.setItem("highScore",this.score.toString())}reset(){this.score=0,this.level=1,this.lives=3}levelUp(){this.level++}}class f{constructor(e){a(this,"x");a(this,"y");a(this,"radius");a(this,"dx",0);a(this,"dy",0);a(this,"baseSpeed");a(this,"speedIncrease");a(this,"ballImage");a(this,"game");this.game=e,this.x=this.game.canvas.width/2,this.y=this.game.canvas.height-40,this.radius=10,this.baseSpeed=5,this.speedIncrease=0,this.ballImage=new Image,this.preloadBallImage(),this.setInitialVelocity()}preloadBallImage(){this.ballImage.src="./images/ball.png"}setInitialVelocity(){const e=this.baseSpeed+this.speedIncrease;this.dx=(Math.random()*2-1)*e,this.dy=-e}draw(e){const t=this.radius*2;e.drawImage(this.ballImage,this.x-this.radius,this.y-this.radius,t,t)}reset(e,t){this.x=e,this.y=t,this.speedIncrease=0,this.setInitialVelocity()}increaseSpeed(e){this.speedIncrease+=e,this.setInitialVelocity()}update(e,t){if((this.x+this.dx>e-this.radius||this.x+this.dx<this.radius)&&(this.dx=-this.dx),this.y+this.dy<this.radius&&(this.dy=-this.dy),this.x>t.x&&this.x<t.x+t.width&&this.y+this.radius>t.y){this.dy=-this.dy;const s=this.x-(t.x+t.width/2);this.dx=s*.1,this.game.soundManager.playSound("paddle")}this.x+=this.dx,this.y+=this.dy}}class x{constructor(e,t,s,i,h,o,r=1){a(this,"x");a(this,"y");a(this,"width");a(this,"height");a(this,"health");a(this,"initialHealth");a(this,"colorIndex");a(this,"image");a(this,"images");this.x=e,this.y=t,this.width=s,this.height=i,this.colorIndex=h,this.images=o,this.image=this.images.new,this.health=r,this.initialHealth=r}hit(){this.health-=1,this.health===1&&this.initialHealth>1&&(this.image=this.images.broken)}draw(e){this.health>0&&e.drawImage(this.image,this.x,this.y,this.width,this.height)}}const w=[{columnCount:7,backgroundImage:"./images/background_6.png",bricks:[{health:1,colorIndex:1},{health:1,colorIndex:0},{health:1,colorIndex:7},{health:2,colorIndex:6},{health:2,colorIndex:8},{health:2,colorIndex:5},{health:2,colorIndex:3}]},{columnCount:7,backgroundImage:"./images/background_7.png",bricks:[{health:1,colorIndex:9},{health:2,colorIndex:8},{health:2,colorIndex:1},{health:2,colorIndex:5},{health:2,colorIndex:6},{health:2,colorIndex:3},{health:1,colorIndex:7}]},{columnCount:9,backgroundImage:"./images/background_8.jpeg",bricks:[{health:2,colorIndex:2},{health:1,colorIndex:8},{health:2,colorIndex:3}]},{columnCount:9,backgroundImage:"./images/background_9.jpeg",bricks:[{health:1,colorIndex:4},{health:1,colorIndex:6},{health:2,colorIndex:2},{health:1,colorIndex:7},{health:1,colorIndex:5},{health:1,colorIndex:1},{health:2,colorIndex:3},{health:2,colorIndex:0},{health:2,colorIndex:9}]},{columnCount:9,backgroundImage:"./images/background_13.jpeg",bricks:[{health:2,colorIndex:5},{health:2,colorIndex:3},{health:1,colorIndex:4}]},{columnCount:8,backgroundImage:"./images/background_10.jpeg",bricks:[{health:1,colorIndex:0},{health:2,colorIndex:2},{health:1,colorIndex:1},{health:1,colorIndex:4},{health:1,colorIndex:5},{health:1,colorIndex:9},{health:2,colorIndex:7},{health:1,colorIndex:8},{health:2,colorIndex:6}]},{columnCount:9,backgroundImage:"./images/background_7.png",bricks:[{health:1,colorIndex:5},{health:2,colorIndex:9},{health:1,colorIndex:7},{health:1,colorIndex:6},{health:2,colorIndex:3},{health:2,colorIndex:4},{health:1,colorIndex:0},{health:1,colorIndex:1}]},{columnCount:8,backgroundImage:"./images/background_6.png",bricks:[{health:1,colorIndex:5},{health:1,colorIndex:7},{health:1,colorIndex:9},{health:2,colorIndex:6}]},{columnCount:7,backgroundImage:"./images/background_10.jpeg",bricks:[{health:2,colorIndex:0},{health:2,colorIndex:7},{health:1,colorIndex:2},{health:2,colorIndex:9},{health:2,colorIndex:8},{health:1,colorIndex:3},{health:2,colorIndex:4}]},{columnCount:9,backgroundImage:"./images/background_12.jpeg",bricks:[{health:2,colorIndex:8},{health:2,colorIndex:6},{health:2,colorIndex:4}]}];class c{constructor(e){a(this,"game");a(this,"backgroundImage");a(this,"backgroundImages");a(this,"bricks",[]);a(this,"brickImages",{});a(this,"width");a(this,"height");a(this,"padding");a(this,"offsetTop");this.game=e,this.backgroundImages=["./images/background_6.png","./images/background_7.png","./images/background_8.jpeg","./images/background_9.jpeg","./images/background_10.jpeg","./images/background_11.jpeg","./images/background_12.jpeg","./images/background_13.jpeg","./images/background_14.jpeg"],this.backgroundImage=this.loadBackgroundImage(),this.preloadBrickImages().then(()=>this.generateBricks()),this.width=75,this.height=20,this.padding=10,this.offsetTop=30}async preloadBrickImages(){const t=i=>new Promise(h=>{const o=new Image;o.onload=()=>h(o),o.src=i}),s=[];for(let i=0;i<10;i++){const h=`./images/brick_0${i}_new.png`,o=`./images/brick_0${i}_broken.png`;s.push(Promise.all([t(h),t(o)]).then(([r,l])=>{this.brickImages[i]={new:r,broken:l}}))}await Promise.all(s)}loadBackgroundImage(){const e=this.game.player.level%this.backgroundImages.length-1;let t=new Image;return t.src=this.backgroundImages[e],t}generateBricks(){const e=this.game.player.level-1,t=w[e];this.backgroundImage.src=t.backgroundImage;let s=(this.game.canvas.width-(t.columnCount*(this.width+this.padding)-this.padding))/2;t.bricks.forEach((i,h)=>{let o=h*(this.height+this.padding)+this.offsetTop;const r={new:this.brickImages[i.colorIndex].new,broken:this.brickImages[i.colorIndex].broken};for(let l=0;l<t.columnCount;l++){let g=l*(this.width+this.padding)+s;this.bricks.push(new x(g,o,this.width,this.height,i.colorIndex,r,i.health))}})}checkLevelProgression(){this.bricks.every(t=>t.health<=0)&&(this.game.player.levelUp(),this.generateBricks(),this.game.resetBallAndPaddle(),this.game.soundManager.playSound("levelup"),this.loadBackgroundImage())}checkBallBrickCollision(){this.bricks.forEach(e=>{e.health>0&&this.game.ball.x>e.x&&this.game.ball.x<e.x+e.width&&this.game.ball.y>e.y&&this.game.ball.y<e.y+e.height&&(this.game.ball.dy*=-1,e.hit(),this.game.player.increaseScore(1),this.game.soundManager.playSound("brick"),this.checkLevelProgression())})}draw(e){this.backgroundImage.complete?e.drawImage(this.backgroundImage,0,0,e.canvas.width,e.canvas.height):this.backgroundImage.onload=()=>{e.drawImage(this.backgroundImage,0,0,e.canvas.width,e.canvas.height)},this.bricks.forEach(t=>t.draw(e))}}function y(n){const e=document.getElementById("levelDisplay");e&&(e.innerHTML="Level: "+n)}function d(n){const e=document.getElementById("livesDisplay");if(e){e.innerHTML="";for(let t=0;t<n;t++){let s=document.createElement("div");s.classList.add("heart"),e.appendChild(s)}}}function b(n){const e=document.getElementById("scoreDisplay");e&&(e.innerHTML="Score: "+n)}function k(n){const e=document.getElementById("highScoreDisplay");e&&(e.innerHTML="High Score: "+n)}function S(n){const s=window.innerWidth/800,i=window.innerHeight/600;let h=Math.min(s,i);h=Math.min(h,1),n.scale=h,n.canvas.style.width=`${800*h}px`,n.canvas.style.height=`${600*h}px`}class M{constructor(){a(this,"musicOn");a(this,"soundOn");a(this,"music");this.musicOn=localStorage.getItem("musicOn")!==null?localStorage.getItem("musicOn")==="true":!0,this.soundOn=localStorage.getItem("soundOn")!==null?localStorage.getItem("soundOn")==="true":!0,this.music=this.loadSound("sounds/music.wav"),this.initializeMusic()}loadSound(e){const t=new Audio(e);return t.load(),t}initializeMusic(){this.music.loop=!0,this.music.volume=.15,this.music.addEventListener("timeupdate",function(){this.currentTime>this.duration-.3&&(this.currentTime=0,this.play())},!1)}tryPlayMusic(){if(this.musicOn){const e=this.music.play();e!==void 0&&e.then(()=>{console.log("Music playback started")}).catch(t=>{console.error("Failed to start music playback:",t)})}}toggleMusic(){this.musicOn=!this.musicOn,localStorage.setItem("musicOn",this.musicOn.toString()),this.musicOn?this.tryPlayMusic():this.music.pause()}toggleSound(){this.soundOn=!this.soundOn,localStorage.setItem("soundOn",this.soundOn.toString())}playSound(e){if(!this.soundOn)return;this.loadSound(`sounds/${e}.mp3`).play()}}class O{constructor(e){a(this,"canvas");a(this,"ctx");a(this,"player");a(this,"paddle");a(this,"level");a(this,"ball");a(this,"inputHandler");a(this,"currentState");a(this,"previousState");a(this,"animationFrameId");a(this,"scale");a(this,"startMenuItems",["Start","Options"]);a(this,"activeStartMenuItem",0);a(this,"activeOptionsMenuItem",0);a(this,"optionsMenuItems",["Music: on","Sound: on","Back"]);a(this,"soundManager");const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Canvas element not found");this.canvas=t,this.canvas.width=800,this.canvas.height=600,window.addEventListener("resize",()=>S(this));const s=window.innerWidth/t.width,i=window.innerHeight/t.height;this.scale=Math.min(s,i),this.ctx=this.canvas.getContext("2d"),this.player=new v("Player1"),this.paddle=new p(this.canvas.width,this.canvas.height),this.level=new c(this),this.ball=new f(this),this.currentState="starting",this.previousState="starting",this.inputHandler=new I(this),this.soundManager=new M}startGame(){this.currentState="playing",this.soundManager.playSound("go"),this.gameLoop()}checkBallBottomCollision(){this.ball.y+this.ball.dy>this.canvas.height-this.ball.radius&&this.loseLife()}loseLife(){this.player.lives-=1,d(this.player.lives),this.player.lives<=0?(this.currentState="gameOver",this.soundManager.playSound("gameover")):(this.resetBallAndPaddle(),this.soundManager.playSound("loselife"))}resetBallAndPaddle(){this.ball.reset(this.canvas.width/2,this.canvas.height-30),this.paddle.x=(this.canvas.width-this.paddle.width)/2}updateGame(){this.paddle.update(),this.ball.update(this.canvas.width,this.paddle),this.level.checkBallBrickCollision(),this.checkBallBottomCollision()}drawGame(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.level.draw(this.ctx),d(this.player.lives),this.ball.draw(this.ctx),this.paddle.draw(this.ctx),y(this.player.level),b(this.player.score),k(this.player.highScore)}drawStartScreen(){const e=new Image;e.onload=()=>{this.ctx.font="80px 'Bangers', cursive",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height),this.startMenuItems.forEach((t,s)=>{this.ctx.fillStyle=s===this.activeStartMenuItem?"white":"grey";let i=(s-1)*70;this.ctx.fillText(t,this.canvas.width/2,this.canvas.height/2+i)})},e.src="./images/splash_screen_3.png"}drawOptionsScreen(){const e=new Image;e.src="./images/splash_screen_2.png",e.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height),this.optionsMenuItems[0]=`Music: ${this.soundManager.musicOn?"on":"off"}`,this.optionsMenuItems[1]=`Sound: ${this.soundManager.soundOn?"on":"off"}`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.optionsMenuItems.forEach((t,s)=>{this.ctx.fillStyle=s===this.activeOptionsMenuItem?"white":"grey";let i=s*70+200;this.ctx.fillText(t,this.canvas.width/2,i)})}}drawGameOver(){this.animationFrameId!==void 0&&cancelAnimationFrame(this.animationFrameId);const e=new Image;e.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height)},e.src="./images/game_over_screen_3.png"}gameLoop(){switch(this.currentState){case"starting":this.drawStartScreen();break;case"playing":this.updateGame(),this.drawGame(),this.animationFrameId=requestAnimationFrame(()=>this.gameLoop());break;case"options":this.drawOptionsScreen();break;case"gameOver":this.drawGameOver();break}}restartGame(){typeof this.animationFrameId<"u"&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0),this.player.reset(),this.level=new c(this),this.resetBallAndPaddle(),this.currentState="playing",this.gameLoop()}}const L=new O("gameCanvas");document.addEventListener("DOMContentLoaded",()=>{L.gameLoop()});
