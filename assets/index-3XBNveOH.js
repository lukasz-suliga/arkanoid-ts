var x=Object.defineProperty;var w=(h,e,t)=>e in h?x(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var i=(h,e,t)=>(w(h,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();class y{constructor(e,t){i(this,"width");i(this,"height");i(this,"x");i(this,"y");i(this,"canvasWidth");i(this,"canvasHeight");i(this,"speed");i(this,"movingLeft");i(this,"movingRight");i(this,"paddleImages");i(this,"animationFrame");i(this,"frameDelay");i(this,"frameDelayCounter");this.width=90,this.height=10,this.x=(e-this.width)/2,this.y=t-this.height-10,this.canvasWidth=e,this.canvasHeight=t,this.speed=6,this.movingLeft=!1,this.movingRight=!1,this.paddleImages=[],this.animationFrame=0,this.frameDelay=10,this.frameDelayCounter=0,this.preloadPaddleImages()}preloadPaddleImages(){for(let e=0;e<3;e++){const t=new Image;t.src=`./images/paddle_${e}.png`,this.paddleImages.push(t)}}moveLeft(){this.x>0&&(this.x-=this.speed)}moveRight(){this.x+this.width<this.canvasWidth&&(this.x+=this.speed)}update(){this.movingLeft&&this.moveLeft(),this.movingRight&&this.moveRight(),this.frameDelayCounter++,this.frameDelayCounter>=this.frameDelay&&(this.animationFrame=(this.animationFrame+1)%this.paddleImages.length,this.frameDelayCounter=0)}draw(e){const s=this.width/3.7890625,o=this.y-s+this.height;e.drawImage(this.paddleImages[this.animationFrame],this.x,o,this.width,s)}}function r(h){const e=new Audio(h);return e.load(),e}const c={brick:r("sounds/brick.mp3"),gameover:r("sounds/gameover.mp3"),go:r("sounds/go.mp3"),levelup:r("sounds/levelup.mp3"),loselife:r("sounds/loselife.mp3"),paddle:r("sounds/paddle.mp3")};function d(h){h.paused||(h.pause(),h.currentTime=0),h.play()}const m=r("sounds/music.wav");m.loop=!0;m.volume=.15;let u=!1;function p(){u||(m.play(),u=!0,m.addEventListener("timeupdate",function(){this.currentTime>this.duration-.3&&(this.currentTime=0,this.play())},!1))}class b{constructor(e,t,n,a){i(this,"paddle");i(this,"getCurrentState");i(this,"restartGame");i(this,"startGame");i(this,"lastTouchX",null);this.paddle=e,this.getCurrentState=t,this.restartGame=n,this.startGame=a,document.addEventListener("keydown",s=>this.keyDownHandler(s)),document.addEventListener("keyup",s=>this.keyUpHandler(s)),document.addEventListener("touchstart",s=>this.touchStartHandler(s)),document.addEventListener("touchmove",s=>this.touchMoveHandler(s)),document.addEventListener("touchend",()=>this.touchEndHandler())}touchStartHandler(e){const t=this.getCurrentState();t==="starting"?(p(),this.startGame()):t==="gameOver"&&this.restartGame(),this.lastTouchX=e.touches[0].clientX}touchMoveHandler(e){if(!this.lastTouchX)return;const t=e.touches[0].clientX,n=t-this.lastTouchX;n<0?(this.paddle.movingLeft=!0,this.paddle.movingRight=!1):n>0&&(this.paddle.movingLeft=!1,this.paddle.movingRight=!0),this.lastTouchX=t}touchEndHandler(){this.paddle.movingLeft=!1,this.paddle.movingRight=!1,this.lastTouchX=null}keyDownHandler(e){const t=this.getCurrentState();if(t==="playing")switch(e.key){case"ArrowLeft":this.paddle.movingLeft=!0;break;case"ArrowRight":this.paddle.movingRight=!0;break}else t==="gameOver"?this.restartGame():t==="starting"&&(p(),this.startGame())}keyUpHandler(e){if(this.getCurrentState()==="playing")switch(e.key){case"ArrowLeft":this.paddle.movingLeft=!1;break;case"ArrowRight":this.paddle.movingRight=!1;break}}}class k{constructor(e){i(this,"name");i(this,"highScore");i(this,"score");i(this,"level");i(this,"lives");this.name=e,this.highScore=Number(localStorage.getItem("highScore"))||0,this.score=0,this.level=0,this.lives=0,this.reset()}increaseScore(e){this.score+=e,this.score>this.highScore&&(this.highScore=this.score,this.saveHighScore())}getHighScore(){return Number(localStorage.getItem("highScore"))||0}saveHighScore(){localStorage.setItem("highScore",this.score.toString())}reset(){this.score=0,this.level=1,this.lives=3}levelUp(){this.level++}}class S{constructor(e,t,n){i(this,"x");i(this,"y");i(this,"radius");i(this,"dx",0);i(this,"dy",0);i(this,"baseSpeed");i(this,"speedIncrease");i(this,"ballImage");this.x=e,this.y=t,this.radius=n,this.baseSpeed=5,this.speedIncrease=0,this.ballImage=new Image,this.preloadBallImage(),this.setInitialVelocity()}preloadBallImage(){this.ballImage.src="./images/ball.png"}setInitialVelocity(){const e=this.baseSpeed+this.speedIncrease;this.dx=(Math.random()*2-1)*e,this.dy=-e}draw(e){const t=this.radius*2;e.drawImage(this.ballImage,this.x-this.radius,this.y-this.radius,t,t)}reset(e,t){this.x=e,this.y=t,this.speedIncrease=0,this.setInitialVelocity()}increaseSpeed(e){this.speedIncrease+=e,this.setInitialVelocity()}update(e,t){if((this.x+this.dx>e-this.radius||this.x+this.dx<this.radius)&&(this.dx=-this.dx),this.y+this.dy<this.radius&&(this.dy=-this.dy),this.x>t.x&&this.x<t.x+t.width&&this.y+this.radius>t.y){this.dy=-this.dy;const n=this.x-(t.x+t.width/2);this.dx=n*.1,d(c.paddle)}this.x+=this.dx,this.y+=this.dy}}class L{constructor(e,t,n,a,s,o,l=1){i(this,"x");i(this,"y");i(this,"width");i(this,"height");i(this,"health");i(this,"initialHealth");i(this,"colorIndex");i(this,"image");i(this,"images");this.x=e,this.y=t,this.width=n,this.height=a,this.colorIndex=s,this.images=o,this.image=this.images.new,this.health=l,this.initialHealth=l}hit(){this.health-=1,this.health===1&&this.initialHealth>1&&(this.image=this.images.broken)}draw(e){this.health>0&&e.drawImage(this.image,this.x,this.y,this.width,this.height)}}const C=[{columnCount:7,backgroundImage:"./images/background_6.png",bricks:[{health:1,colorIndex:1},{health:1,colorIndex:0},{health:1,colorIndex:7},{health:2,colorIndex:6},{health:2,colorIndex:8},{health:2,colorIndex:5},{health:2,colorIndex:3}]},{columnCount:7,backgroundImage:"./images/background_7.png",bricks:[{health:1,colorIndex:9},{health:2,colorIndex:8},{health:2,colorIndex:1},{health:2,colorIndex:5},{health:2,colorIndex:6},{health:2,colorIndex:3},{health:1,colorIndex:7}]},{columnCount:9,backgroundImage:"./images/background_8.jpeg",bricks:[{health:2,colorIndex:2},{health:1,colorIndex:8},{health:2,colorIndex:3}]},{columnCount:9,backgroundImage:"./images/background_9.jpeg",bricks:[{health:1,colorIndex:4},{health:1,colorIndex:6},{health:2,colorIndex:2},{health:1,colorIndex:7},{health:1,colorIndex:5},{health:1,colorIndex:1},{health:2,colorIndex:3},{health:2,colorIndex:0},{health:2,colorIndex:9}]},{columnCount:9,backgroundImage:"./images/background_13.jpeg",bricks:[{health:2,colorIndex:5},{health:2,colorIndex:3},{health:1,colorIndex:4}]},{columnCount:8,backgroundImage:"./images/background_10.jpeg",bricks:[{health:1,colorIndex:0},{health:2,colorIndex:2},{health:1,colorIndex:1},{health:1,colorIndex:4},{health:1,colorIndex:5},{health:1,colorIndex:9},{health:2,colorIndex:7},{health:1,colorIndex:8},{health:2,colorIndex:6}]},{columnCount:9,backgroundImage:"./images/background_7.png",bricks:[{health:1,colorIndex:5},{health:2,colorIndex:9},{health:1,colorIndex:7},{health:1,colorIndex:6},{health:2,colorIndex:3},{health:2,colorIndex:4},{health:1,colorIndex:0},{health:1,colorIndex:1}]},{columnCount:8,backgroundImage:"./images/background_6.png",bricks:[{health:1,colorIndex:5},{health:1,colorIndex:7},{health:1,colorIndex:9},{health:2,colorIndex:6}]},{columnCount:7,backgroundImage:"./images/background_10.jpeg",bricks:[{health:2,colorIndex:0},{health:2,colorIndex:7},{health:1,colorIndex:2},{health:2,colorIndex:9},{health:2,colorIndex:8},{health:1,colorIndex:3},{health:2,colorIndex:4}]},{columnCount:9,backgroundImage:"./images/background_12.jpeg",bricks:[{health:2,colorIndex:8},{health:2,colorIndex:6},{health:2,colorIndex:4}]}];class I{constructor(e){i(this,"game");i(this,"backgroundImage");i(this,"backgroundImages");i(this,"bricks",[]);i(this,"brickImages",{});i(this,"width");i(this,"height");i(this,"padding");i(this,"offsetTop");this.game=e,this.backgroundImages=["./images/background_6.png","./images/background_7.png","./images/background_8.jpeg","./images/background_9.jpeg","./images/background_10.jpeg","./images/background_11.jpeg","./images/background_12.jpeg","./images/background_13.jpeg","./images/background_14.jpeg"],this.backgroundImage=this.loadBackgroundImage(),this.preloadBrickImages().then(()=>this.generateBricks()),this.width=75,this.height=20,this.padding=10,this.offsetTop=30}async preloadBrickImages(){const t=a=>new Promise(s=>{const o=new Image;o.onload=()=>s(o),o.src=a}),n=[];for(let a=0;a<10;a++){const s=`./images/brick_0${a}_new.png`,o=`./images/brick_0${a}_broken.png`;n.push(Promise.all([t(s),t(o)]).then(([l,g])=>{this.brickImages[a]={new:l,broken:g}}))}await Promise.all(n)}loadBackgroundImage(){const e=this.game.player.level%this.backgroundImages.length-1;let t=new Image;return t.src=this.backgroundImages[e],t}generateBricks(){const e=this.game.player.level-1,t=C[e];this.backgroundImage.src=t.backgroundImage;let n=(this.game.canvas.width-(t.columnCount*(this.width+this.padding)-this.padding))/2;t.bricks.forEach((a,s)=>{let o=s*(this.height+this.padding)+this.offsetTop;const l={new:this.brickImages[a.colorIndex].new,broken:this.brickImages[a.colorIndex].broken};for(let g=0;g<t.columnCount;g++){let f=g*(this.width+this.padding)+n;this.bricks.push(new L(f,o,this.width,this.height,a.colorIndex,l,a.health))}})}checkLevelProgression(){this.bricks.every(t=>t.health<=0)&&(this.game.player.levelUp(),this.generateBricks(),this.game.resetBallAndPaddle(),d(c.levelup),this.loadBackgroundImage())}checkBallBrickCollision(){this.bricks.forEach(e=>{e.health>0&&this.game.ball.x>e.x&&this.game.ball.x<e.x+e.width&&this.game.ball.y>e.y&&this.game.ball.y<e.y+e.height&&(this.game.ball.dy*=-1,e.hit(),this.game.player.increaseScore(1),d(c.brick),this.checkLevelProgression())})}draw(e){this.backgroundImage.complete?e.drawImage(this.backgroundImage,0,0,e.canvas.width,e.canvas.height):this.backgroundImage.onload=()=>{e.drawImage(this.backgroundImage,0,0,e.canvas.width,e.canvas.height)},this.bricks.forEach(t=>t.draw(e))}}function H(h){const e=document.getElementById("levelDisplay");e&&(e.innerHTML="Level: "+h)}function v(h){const e=document.getElementById("livesDisplay");if(e){e.innerHTML="";for(let t=0;t<h;t++){let n=document.createElement("div");n.classList.add("heart"),e.appendChild(n)}}}function B(h){const e=document.getElementById("scoreDisplay");e&&(e.innerHTML="Score: "+h)}function _(h){const e=document.getElementById("highScoreDisplay");e&&(e.innerHTML="High Score: "+h)}function E(h){const n=window.innerWidth/800,a=window.innerHeight/600;let s=Math.min(n,a);s=Math.min(s,1),h.scale=s,h.canvas.style.width=`${800*s}px`,h.canvas.style.height=`${600*s}px`}class P{constructor(e){i(this,"canvas");i(this,"ctx");i(this,"player");i(this,"paddle");i(this,"level");i(this,"ball");i(this,"inputHandler");i(this,"currentState");i(this,"animationFrameId");i(this,"scale");const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Canvas element not found");this.canvas=t,this.canvas.width=800,this.canvas.height=600,window.addEventListener("resize",()=>E(this));const n=window.innerWidth/t.width,a=window.innerHeight/t.height;this.scale=Math.min(n,a),this.ctx=this.canvas.getContext("2d"),this.player=new k("Player1"),this.paddle=new y(this.canvas.width,this.canvas.height),this.level=new I(this),this.ball=new S(this.canvas.width/2,this.canvas.height-40,10),this.currentState="starting",this.inputHandler=new b(this.paddle,()=>this.currentState,()=>this.restartGame(),()=>this.startGame())}startGame(){this.currentState="playing",d(c.go),this.gameLoop()}checkBallBottomCollision(){this.ball.y+this.ball.dy>this.canvas.height-this.ball.radius&&this.loseLife()}loseLife(){this.player.lives-=1,v(this.player.lives),this.player.lives<=0?(this.currentState="gameOver",d(c.gameover)):(this.resetBallAndPaddle(),d(c.loselife))}resetBallAndPaddle(){this.ball.reset(this.canvas.width/2,this.canvas.height-30),this.paddle.x=(this.canvas.width-this.paddle.width)/2}updateGame(){this.paddle.update(),this.ball.update(this.canvas.width,this.paddle),this.level.checkBallBrickCollision(),this.checkBallBottomCollision()}drawGame(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.level.draw(this.ctx),v(this.player.lives),this.ball.draw(this.ctx),this.paddle.draw(this.ctx),H(this.player.level),B(this.player.score),_(this.player.highScore)}drawStartScreen(){const e=new Image;console.log(this.scale),e.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height)},e.src="./images/splash_screen_3.png"}drawGameOver(){this.animationFrameId!==void 0&&cancelAnimationFrame(this.animationFrameId);const e=new Image;e.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(e,0,0,this.canvas.width,this.canvas.height)},e.src="./images/game_over_screen_3.png"}gameLoop(){switch(this.currentState){case"starting":this.drawStartScreen();break;case"playing":this.updateGame(),this.drawGame(),this.animationFrameId=requestAnimationFrame(()=>this.gameLoop());break;case"gameOver":this.drawGameOver();break}}restartGame(){typeof this.animationFrameId<"u"&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0),this.player.reset(),this.level=new I(this),this.resetBallAndPaddle(),this.currentState="playing",this.gameLoop()}}const G=new P("gameCanvas");document.addEventListener("DOMContentLoaded",()=>{G.gameLoop()});
